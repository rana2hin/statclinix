% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/correlation_table.R
\name{correlation_table}
\alias{correlation_table}
\title{Create and Optionally Save a Styled Correlation Table}
\usage{
correlation_table(data, base = NULL, base_to_base = FALSE, save_as_docx = NULL)
}
\arguments{
\item{data}{A data.frame containing the data. Must have at least two numeric columns.}

\item{base}{An optional character vector of column names or a numeric vector of
column indices to be used as the base for correlation. If NULL (the default),
all-pairs correlations are computed.}

\item{base_to_base}{A logical value. If `TRUE` and `base` contains more than one
variable, correlations between the base variables themselves are also calculated.
Defaults to `FALSE`.}

\item{save_as_docx}{An optional character string. If provided, specifies the file
path and name (e.g., "reports/correlation_table.docx") where the output table
should be saved as a Word document. Defaults to `NULL`, in which case the table
is not saved to a file.}
}
\value{
A `gt_tbl` object.
}
\description{
This function calculates Pearson correlation coefficients and p-values for pairs of
numeric variables in a data frame. It can operate on all possible pairs or on
pairs relative to a specified set of base variables. The output is a `gt` table,
which can also be saved as a .docx file.
}
\examples{
# Create a sample data frame
set.seed(123)
sample_data <- data.frame(
  hs_CRP = rnorm(100),
  ALT = rnorm(100),
  AST = rnorm(100),
  FBG = rnorm(100),
  TG = rnorm(100),
  BMI = rnorm(100),
  NonNumeric = sample(letters, 100, replace = TRUE)
)

# Example 1: Correlation of all numeric variables
# correlation_table(sample_data)

# Example 2: Correlation with a single base variable
# correlation_table(sample_data, base = "hs_CRP")

# Example 3: Correlation with multiple base variables
# correlation_table(sample_data, base = c("hs_CRP", "BMI"))

# Example 4: Correlation with multiple base variables, including base-to-base
# correlation_table(sample_data, base = c("hs_CRP", "BMI"), base_to_base = TRUE)

# Example 5: Save the output to a Word document
# temp_file <- tempfile(fileext = ".docx")
# correlation_table(sample_data, base = "hs_CRP", save_as_docx = temp_file)
# print(paste("Table saved to:", temp_file))
}
